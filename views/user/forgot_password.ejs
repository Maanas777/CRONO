<%- include ('../partials/user-Header')%>
<%- include ('../partials/user_nav')%>

    <section class="signin-page account">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3">
                    <div class="block text-center">
                        <a class="logo" href="index.html">
                            <img src="images/logo.png" alt="">
                        </a>
                        <h2 class="text-center">Reset Your Password</h2>
                        <form class="text-left clearfix" action="/verify_password" method="post"
                            onsubmit="return validateBasic()">

                            <div class="form-group">
                                <input type="password" name="password" class="form-control"
                                    placeholder="Enter Your New Password">
                            </div>
                            <% if(locals.alert) { %>
                                <div id="msg" class="alert alert-danger" style="color: black;">
                                    <%- locals.alert%>
                                </div>
                                <% } %>

                                    <div class="form-group">
                                        <input type="password" name="confirmpassword" class="form-control"
                                            placeholder="Confirm Password">
                                    </div>
                                    <% if(locals.message) { %>
                                        <div id="msg" class="alert alert-danger" style="color: black;">
                                            <%- locals.message %>
                                        </div>
                                        <% } %>

                                            <div class="text-center">
                                                <button type="submit" class="btn btn-main text-center">Change
                                                    Password</button>
                                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </section>
    <%- include ('../partials/user-Footer')%>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/11.7.6/sweetalert2.min.js"
            integrity="sha512-7n7l/pwyBrGoI8Wi1wgGpOMiskOKjK673MiQ7W7ZszBUHkSxoowEi4TLhd433u7YCtth+EpJwAX9IsWWOTtHFg=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>

        <script>
            function validateBasic() {
                const password = document.querySelector('input[name="password"]').value;
                const confirmPassword = document.querySelector('input[name="confirmpassword"]').value;

                // Check password strength (at least 8 characters, with at least one uppercase letter, one lowercase letter, and one number)
                const passwordRegex = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;
                if (!passwordRegex.test(password)) {
                    swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: 'Password must be at least 8 characters long and include at least one uppercase letter, one lowercase letter, and one number. ',
                        confirmButtoolor: '#000000',
                    });
                    return false;
                }

                // Check if password and confirm password match
                if (password !== confirmPassword) {
                    swal.fire({
                        icon: 'error',
                        title: 'Error',
                        text: 'password is not matching confirm the password. ',
                        confirmButtoolor: '#000000',
                    });
                    return false;
                }

                return true;
            }
        </script>